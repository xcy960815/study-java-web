# è·å–æäº¤ä¿¡æ¯
COMMIT_MSG=$(cat "$1")

# å¦‚æœæäº¤ä¿¡æ¯ä¸ºç©ºï¼Œåˆ™è¿è¡Œäº¤äº’å¼æäº¤
if [ -z "$COMMIT_MSG" ]; then
  npm run commit
  exit 0
fi

# æ£€æŸ¥æäº¤ä¿¡æ¯æ ¼å¼
if ! echo "$COMMIT_MSG" | grep -qE '^(feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert|wip)(\([a-z]+\))?: .+$'; then
  echo "\nâŒ æäº¤ä¿¡æ¯æ ¼å¼é”™è¯¯ï¼"
  echo "è¯·ä½¿ç”¨ä»¥ä¸‹æ ¼å¼æäº¤ï¼š"
  echo "  type(scope): subject"
  echo ""
  echo "ä¾‹å¦‚ï¼š"
  echo "  feat(math): æ·»åŠ æ•°å­¦ç»ƒä¹ åŠŸèƒ½"
  echo "  fix(user): ä¿®å¤ç™»å½•é—®é¢˜"
  echo ""
  echo "type å¯é€‰å€¼ï¼š"
  echo "  âœ¨ feat:     æ–°åŠŸèƒ½"
  echo "  ğŸ› fix:      ä¿®å¤bug"
  echo "  ğŸ“š docs:     æ–‡æ¡£æ›´æ–°"
  echo "  ğŸ’ style:    ä»£ç æ ¼å¼è°ƒæ•´"
  echo "  ğŸ“¦ refactor: ä»£ç é‡æ„"
  echo "  ğŸš€ perf:     æ€§èƒ½ä¼˜åŒ–"
  echo "  ğŸš¨ test:     æµ‹è¯•ç›¸å…³"
  echo "  ğŸ‘· build:    æ„å»ºç›¸å…³"
  echo "  âš™ï¸  ci:       CIé…ç½®ç›¸å…³"
  echo "  â™»ï¸  chore:    æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨"
  echo "  ğŸ—‘  revert:   å›æ»š"
  echo "  ğŸš§ wip:      å¼€å‘ä¸­"
  echo ""
  echo "scope å¯é€‰å€¼ï¼š"
  echo "  math, user, admin, system, config"
  echo ""
  echo "æˆ–è€…ä½¿ç”¨ npm run commit è¿›è¡Œäº¤äº’å¼æäº¤"
  exit 1
fi

# ä½¿ç”¨commitlintæ£€æŸ¥æäº¤ä¿¡æ¯
npx --no -- commitlint --edit "$1"
